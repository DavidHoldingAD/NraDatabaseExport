# NRA Database Export

### Въведение

Този проект цели да изпълни изискванията на [Наредба Н-18](https://lex.bg/laws/ldoc/2135540645) на Министъра на финансите на Р България.

Наредбата изисква всеки разработчик на софтуер управляващ продажби заплащани в брой да предостави изходния код на инструмент за извличане
на съответните данни от базата данни.

Точният текст на чл.52в, ал.2, т.3 гласи:

> 3. (доп. - ДВ, бр. 26 от 2019 г., в сила от 29.03.2019 г.) за софтуери, които се инсталират в среда на клиента, се представят: пълно
> описание на обектите в базата данни (БД), свързани с управлението на продажбите, вкл. таблици и предназначението им, връзки между тях,
> описание на полетата в таблиците, както и изпълним файл и source-кодът, от който е генериран изпълнимият файл, за достъп и извличане на
> данни от БД в структуриран четим вид с възможност за избор - от всички или от част от таблиците, с които работи софтуерът, когато
> информацията, съдържаща се в експортираните от изпълнимия файл таблици, представлява лични данни по смисъла на Регламент (ЕС) 2016/679 на
> Европейския парламент и на Съвета от 27 април 2016 (ОВ, L119 от 4 май 2016 г.) или здравна информация по смисъла на чл. 27 от Закона за
> здравето, при експорта тези данни не се извличат;

### Системни изисквания

За коректна работа с приложението, следните системни изисквания трябва да бъдат изпълнени:

- Microsoft Windows 7+ (64-bit)
- .NET Core 3.1+

### Поддържани бази данни

- SQLite
- MySQL/MariaDB
- Microsoft SQL Server
- Microsoft Access
- Firebird Server
- ODBC

### Поддържани файлови формати

- CSV - текстов файл, в който стойностите са разделени съобразно текущите регионални настройки
- Comma-separated CSV - текстов файл, в който стойностите са разделени със знак "," (запетая)
- Semicolon-separated CSV - текстов файл, в който стойностите са разделени със знак ";" (точка и запетая)
- JSON - текстов файл, съобразен с [RFC 8259](https://tools.ietf.org/html/rfc8259)

### Ръководство за работа

Експортирането на данни с приложението "NRA Database Export" става стъпка по стъпка, както следва:

1. Екран **Добре дошли**

   На този екран се вижда обща информация за приложението.

   Натиснете бутон **Напред**, за да продължите.

2. Екран **Настройка на СУБД**

   1. В поле **Тип СУБД** се посочва типа на базата данни (напр. "Microsoft SQL Server").

      Забележка: За списък с поддържаните типове бази данни, вж. глава "Поддържани бази данни".

   2. В зависимост от посочения тип СУБД:

     - Ако е избрана СУБД от файлов тип:

       1. В поле **Файл** се посочва съответният файл.

     - Иначе:

       1. В поле **База данни** се избира съответната база данни;
       2. В поле **Порт** се попълва порта за връзка;

          Забележка: Ако полето не е попълнено, се използва портът по подразбиране.

       2. В поле **Потребител** се попълва потребителското име за вход;
       3. В поле **Парола** се посочва паролата за вход;

   3. Натиснете бутон **Напред**, за да продължите, или **Назад** за връщане към предишния екран.

3. Екран **Избор на база данни**

   1. В зависимост от посочения тип база данни:

      - Ако е избрана СУБД, която не поддържа множество бази данни, списъкът остава празен може да се премине към следващия екран.
      - Иначе, от списъка **База данни** се избира (маркира) базата данни, от която ще бъдат експортирани данни.

   2. Натиснете бутон **Напред**, за да продължите, или **Назад** за връщане към предишния екран.

4. Екран **Избор на таблици**

   1. В списъка **Таблици** се маркират една или повече таблици, от които да бъдат експортирани данни.

   2. Натиснете бутон **Напред**, за да продължите, или **Назад** за връщане към предишния екран.

5. Екран **Настройка на експорт**

   1. В поле **Тип експорт** се посочва форматът, в който да бъдат експортираните данни

      Забележка: За списък с поддържаните файлови формати, вж. глава "Поддържани файлови формати".

   2. В поле **Път за експорт** се посочва папката (директорията), в която да бъдат записани файловете с експортираните данни.

   3. Натиснете бутон **Напред**, за да продължите, или **Назад** за връщане към предишния екран.

6. Екран **Експортиране**

   1. В поле **Състояние** са изброени избраните за експортиране таблици, като таблицата съдържа следните колони:
   
      - Колона **Наименование** съдържа наименованието на таблицата (с нейната схема, ако има такава).
      - Колона **Записи** съдържа броя на експортираните от съответната таблицата записи.
      - Колона **Статус** съдържа състоянието на експортирането на таблицата, като то може да бъде:
        - **Busy**, ако данните от таблицата в момента се експортират;
        - **Ok**, ако данните от таблицата са експортирани успешно;
        - **Error**, ако е възникнала грешка при експортиране на данните от таблицата.

   2. Натиснете бутон **Експортирай**, за да експортирате данните, или **Назад** за връщане към предишния екран.

   Забележки:

   - По време на експортирането, данните в поле **Състояние** в реално време се отразява състоянието на експортирането.
   - При успешно приключване на експортирането на данни, се отваря диалогов прозорец, който известява за това.
   - При възникнала грешка по време на експортирането на данни, се отваря диалогов прозорец с информация за грешката.

### Сътрудничество

Този проект е разклонение на [NapDatabaseExport](https://github.com/flipm0de/NapDatabaseExport).
